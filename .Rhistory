# Does handling response predict persistence?
## Box plot
ggplot(data, aes(score, sqrt(persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()
## ANOVA to test whether score is a good predictor of persistence
m2c <- glm(sqrt(persist) ~ score,
data = data)
anova(m2c, test = "F")
## Predictions
predict(m2c, newdata = data.frame(score = as.factor(c(1,2,3))), type = "response")^2
## Predictions
predict(m2c, newdata = data.frame(score = as.factor(c(1,2,3))),
type = "response")^2
## Predictions
predict(m2c, newdata = data.frame(score = (c(1,2,3))),
type = "response")^2
## ANOVA to test whether score is a good predictor of persistence
m2c <- glm(sqrt(persist) ~ score,
data = data)
anova(m2c, test = "F")
## Predictions
predict(m2c, newdata = data.frame(score = c(1,2,3)), type = "response")^2
# m3a: Does behaviour predict survival to 90 days?
## Box plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_boxplot()+
labs(y = "Proportion of time spent alert")+
theme_minimal()
# m3a: Does behaviour predict survival to 90 days?
## Box plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(y = "Proportion of time spent alert")+
theme_minimal()
# m3a: Does behaviour predict survival to 90 days?
## Violin plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(y = "Proportion of time spent alert")+
theme_minimal()
# Does handling response predict persistence?
## Violin plot
ggplot(data, aes(score, sqrt(persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()+
labs(x= "Survival to 90-days post-release",
y = "Handling Response")+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Does handling response predict persistence?
## Violin plot
ggplot(data, aes(score, sqrt(persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()+
labs(x= "Survival to 90-days post-release",
y = "Handling Response")+
theme_minimal()+
theme(panel.grid.minor = element_blank())
# Does handling response predict persistence?
## Violin plot
ggplot(data, aes(score, sqrt(persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()+
labs(x= "Post-release persistence (days)",
y = "Handling Response")+
theme_minimal()+
theme(panel.grid.minor = element_blank())
# Does handling response predict persistence?
## Violin plot
ggplot(data, aes(score, sqrt(persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()+
labs(x= "Handling Response",
y = "Post-release persistence (days)")+
theme_minimal()+
theme(panel.grid.minor = element_blank())
# Does handling response predict persistence?
## Violin plot
ggplot(data, aes(score, (persist), group = score))+
geom_violin()+
geom_point(size = 2)+
theme_minimal()+
labs(x= "Handling Response",
y = "Post-release persistence (days)")+
theme_minimal()+
theme(panel.grid.minor = element_blank())
## Logistic regression with Gamma family because persistence is positively skewed
m1c <- glm(persist ~ score),
## Logistic regression with Gamma family because persistence is positively skewed
m1c <- glm(persist ~ score,
data = data,
family = Gamma(link = "log"))
summary(m1c)
anova(m1c)
anova(m1c, test = "F")
## ANOVA to test whether score is a good predictor of persistence
m2c <- glm(sqrt(persist) ~ score,
data = data)
anova(m2c, test = "F")
## ANOVA to test whether score is a good predictor of persistence (Gamma for persistence right skew)
m2c <- glm(persist ~ score,
data = data,
family = Gamma(link = "log"))
anova(m2c, test = "F")
check_model(m2c)
## Predictions
predict(m2c, newdata = data.frame(score = c(1,2,3)), type = "response")^2
## Predictions
predict(m2c, newdata = data.frame(score = c(1,2,3)), type = "response")
# m3a: Does behaviour predict survival to 90 days?
## Violin plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(y = "Proportion of time spent alert")+
theme_minimal()
# m3a: Does behaviour predict survival to 90 days?
## Violin plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1-year post-release",
y = "Proportion of time spent alert")+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
## Logistic regression with binomial family
m3a <- lm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = m3_data,
family = binomial)
summary(m3a)
## Logistic regression with binomial family
m3a <- lm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial)
summary(m3a)
## Logistic regression with binomial family
m3a <- glm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial)
summary(m3a)
?binomial
## Logistic regression with binomial family
m3a <- glm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial(link = "logit"))
summary(m3a)
## Logistic regression with binomial family
m3a <- glm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial(link = "log"))
## Logistic regression with binomial family
m3a <- glm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3a)
## Logistic regression with binomial family
m3a <- lm(to_90 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3a)
## GLM
m3b <- glmmTMB(to_360 ~ pv,
data = m3_data,
family = binomial())
summary(m3b)
## GLM
m3b <- glmmTMB(to_360 ~ pv,
data = data,
family = binomial())
summary(m3b)
## GLM
m3b <- glmmTMB(to_360 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3b)
## GLM
m3b <- glm(to_360 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3b)
## GLM
m3b <- lm(to_360 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3b)
# m3a: Does behaviour predict survival to 90 days?
## Violin plot
ggplot(data, aes(x= to_90, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 90-days post-release",
y = "Proportion of time spent alert")+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# m3b: Does behaviour predict survival to 1 year?
## Violin plot
ggplot(data, aes(x= to_360, y= alert, group = to_90))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1-year post-release",
y = "Proportion of time spent alert")+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# m3b: Does behaviour predict survival to 1 year?
## Violin plot
ggplot(data, aes(x= to_360, y= alert, group = to_360))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1-year post-release",
y = "Proportion of time spent alert")+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
## Logistic regression with binomial family testing all combos
m3b <- lm(to_360 ~ A + HB + HT + TW + E + P + alert,
data = data,
family = binomial())
summary(m3b)
# m3c: Does behaviour predict persistence?
## Box Plot
ggplot(m3_data, aes(persist, pv))+
geom_point()+
geom_smooth(method = "lm")+
labs(y = "Proportion of time spent vigilant")+
theme_minimal()
# m3c: Does behaviour predict persistence?
## Box Plot
ggplot(data, aes(persist, alert))+
geom_point()+
geom_smooth(method = "lm")+
labs(y = "Proportion of time spent vigilant")+
theme_minimal()
# m3c: Does behaviour predict persistence?
## Box Plot
ggplot(data, aes(persist, alert))+
geom_point()+
geom_smooth(method = "lm")+
labs(y = "Proportion of time spent alert")+
theme_minimal()
# m3c: Does behaviour predict persistence?
## Box Plot
ggplot(data, aes(persist, alert))+
geom_point()+
geom_smooth(method = "lm")+
labs(y = "Proportion of time spent alert")+
theme_minimal()+
+
theme(panel.grid.minor = element_blank())
# m3c: Does behaviour predict persistence?
## Box Plot
ggplot(data, aes(persist, alert))+
geom_point()+
geom_smooth(method = "lm")+
labs(y = "Proportion of time spent alert")+
theme_minimal()+
theme(panel.grid.minor = element_blank())
## Logistic regression with binomial family
m3c <- glm(persist ~ alert,
data = data,
family = nbinom2(link = "log"))
## Logistic regression with binomial family
m3c <- glmmTMB(persist ~ alert,
data = data,
family = nbinom2(link = "log"))
summary(m3c)
## Logistic regression with binomial family
m3c <- glm(persist ~ alert,
data = data,
family = Gamma())
summary(m3c)
## Logistic regression with binomial family
m3c <- glm(persist ~ alert,
data = data,
family = Gamma(link = "log"))
summary(m3c)
View(data)
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ latency + score + sex + weight + age + condition + origin2,
data = data)
## ANOVA to test whether score is a good predictor of persistence (Gamma for persistence right skew)
m2c <- glm(persist ~ score,
data = data,
family = Gamma(link = "logit"))
anova(m2c, test = "F")
## ANOVA to test whether score is a good predictor of persistence (Gamma for persistence right skew)
m2c <- glm(persist ~ score,
data = data,
family = Gamma(link = "log"))
anova(m2c, test = "F")
## Logistic regression with binomial family
m1a <- glm(to_90 ~ sqrt(latency),
data = data,
family = binomial())
summary(m1a)
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ latency + score + sex + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
# m4a: What predicts survival to 90 days?
m4a <- lm(to_90 ~ latency + score + sex + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ latency + score + sex + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
# m4a: What predicts survival to 90 days?
m4a <- glmmTMB(to_90 ~ latency + score + sex + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
View(data)
# m4a: What predicts survival to 90 days?
m4a <- glmmTMB(to_90 ~ sqrt(latency) + score + sex + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
# m4a: What predicts survival to 90 days?
m4a <- glmmTMB(to_90 ~ sqrt(latency) + as.factor(score) + as.factor(sex) + weight + age + condition + origin2,
data = data,
family = binomial())
summary(m4a)
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ sqrt(latency) + as.factor(score) + as.factor(sex) + weight + as.factor(age) + as.factor(condition) + as.factor(origin2),
data = data,
family = binomial())
summary(m4a)
anova(m4a)
anova(m4a, test = "F")
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2),
data = data,
family = binomial())
anova(m4a, test = "F")
View(data)
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m4a, test = "F")
# m4b: What predicts survival to 1 year?
m4a <- glm(to_360 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
# m4b: What predicts survival to 1 year?
m4b <- glm(to_360 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m4b, test = "F")
mosaicplot(table(data$to_360, data$score),
main = NULL,
xlab = "Survival to 1-year post-release",
ylab = "Handling score")
chisq.test(table(data$to_360, data$score))
# m4b: What predicts persistence?
m4b <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = Gamma(link = "log"))
# m4b: What predicts persistence?
m4c <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = Gamma(link = "log"))
anova(m4c, test = "F")
# m4b: What predicts persistence?
m4c <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data)
anova(m4c, test = "F")
# m4b: What predicts persistence?
m4c <- glm(sqrt(persist) ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data)
anova(m4c, test = "F")
anova(m4c, test = "F")
# m4b: What predicts persistence?
m4c <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = Gamma(link = "log"))
anova(m4c, test = "F")
# m4a: What predicts survival to 90 days?
m4a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m4a, test = "F")
# m4b: What predicts survival to 1 year?
m4b <- glm(to_360 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m4b, test = "F")
# m4b: What predicts persistence?
m4c <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = Gamma(link = "log"))
anova(m4c, test = "F")
# m1a: What predicts survival to 90 days?
m1a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m1a, test = "F")
# m1b: What predicts survival to 1 year?
m1b <- glm(to_360 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m1b, test = "F")
# m1c: What predicts persistence?
m1c <- glm(persist ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = Gamma(link = "log"))
anova(m1c, test = "F")
# m1a: What predicts survival to 90 days?
m1a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m1a, test = "F")
check_model(m1a)
check_model(m1b)
check_model(m1c)
# Survived to 90 days
mosaicplot(table(reach_data$to_90, reach_data$reach))
chisq.test(table(reach_data$to_90, reach_data$reach))
# Survived to 360 days
mosaicplot(table(reach_data$to_360, reach_data$reach))
chisq.test(table(reach_data$to_360, reach_data$reach))
check_model(m1c)
summary(m1c)
## Logistic regression with Gamma family because persistence is positively skewed
m2c <- glm(persist ~ sqrt(latency),
data = data,
family = Gamma(link = "log"))
summary(m2c)
## ANOVA to test whether score is a good predictor of persistence (Gamma for persistence right skew)
m3c <- glm(persist ~ score,
data = data,
family = Gamma(link = "log"))
anova(m3c, test = "F")
summary(m3c)
View(data)
# m1a: What predicts survival to 90 days?
m1a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus + HB + HT + TW,
data = data,
family = binomial())
anova(m1a, test = "F")
# Plot time spent alert
ggplot(prop_behav) +
geom_bar(aes(x= bird, y= alert), position = "dodge", stat = "identity")+
labs(x= element_blank(),
y = "Proportion of time spent in alert behaviours")+
scale_x_discrete(guide = guide_axis(angle = 45)) +
theme_minimal()+
theme(panel.grid.minor = element_blank())
# Check distribution of alert behaviours
hist(data$alert)
# Check distribution of alert behaviours
hist(data$HB)
hist(data$HB)
hist(data$HT)
hist(data$TW)
hist(sqrt(data$HB))
hist(sqrt(data$HT))
hist(sqrt(data$TW))
hist(log(data$TW))
hist(log(data$HB))
hist(log(data$HT))
hist(sqrt(data$TW))
# m1a: What predicts survival to 90 days?
m1a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus + sqrt(HB) + sqrt(HT) + sqrt(TW),
data = data,
family = binomial())
anova(m1a, test = "F")
# m1a: What predicts survival to 90 days?
m1a <- glm(to_90 ~ sqrt(latency) + alert + as.factor(score) + as.factor(sex) + weight +
as.factor(age) + as.factor(condition) + as.factor(origin2) + tarsus,
data = data,
family = binomial())
anova(m1a, test = "F")
anova(m1b, test = "F")
source("~/.active-rstudio-document", echo=TRUE)
# Check distribution of behaviours
hist(data$alert)
# Check distribution of behaviours
hist(prop_behav$alert)
