summary(m8)
# Chunk 19: m9
# Fit a survival model with condition as the grouping variable
km9 <- survfit(Surv(time, status) ~ condition, km)
# Kaplan Meyer Plot
ggsurvplot(km9, data = km, risk.table = FALSE,
gtheme = theme_bw(),
censor = FALSE,
xlab = "Days post-release",
xlim = c(0,360),
conf.int = FALSE)
# Test the difference between these survival curves
survdiff(Surv(time, status) ~ condition, km)
# Test as a Cox Proportional Hazard model
m9 <- coxph(Surv(time, status) ~ condition, km)
summary(m9)
# Chunk 20: m10
# Fit a survival model with latency as the continuous variable
m10 <- coxph(Surv(time, status) ~ sqrt(latency), km, x= TRUE)
# Plot the survival area
plot_surv_area(model = m10, data = km,
time = "time", status = "status", variable = "latency", group = NULL)
# Test effect of latency - log rank test
summary(m10)
# Chunk 21: m11
# Fit a survival model with alert behaviour as the continuous variable
m11 <- coxph(Surv(time, status) ~ alert, km, x= TRUE)
# Plot the survival area
plot_surv_area(model = m11, data = km,
time = "time", status = "status", variable = "alert", group = NULL)
# Test effect of alert behaviour - log rank test
summary(m11)
# Chunk 22: m12
# m12 a survival model with weight as the continuous variable
m12 <- coxph(Surv(time, status) ~ weight, km, x= TRUE)
# Plot the survival area
plot_surv_area(model = m12, data = km,
time = "time", status = "status", variable = "weight", group = NULL)
# Test effect of weight - log rank test
summary(m12)
# Chunk 23: m13
# Fit a survival model with weight and sex
m13 <- coxph(Surv(time, status) ~ weight * sex, km, x= TRUE)
# Plot the survival area
plot_surv_area(model = m13, data = km,
time = "time", status = "status", variable = "weight", group = "sex")
# Test effect of alert behaviour - log rank test
summary(m13)
# Chunk 24: aicc
# Comparison of persistence models
AICc(m6, m7, m8, m9, m10, m11, m12, m13)
# Comparison of persistence models
lapply(c(m6, m7, m8, m9, m10, m11, m12, m13), extractAIC)
# Comparison of persistence models
lapply(list(m6, m7, m8, m9, m10, m11, m12, m13), extractAIC)
# Comparison of persistence models
lapply(c(m6, m7, m8, m9, m10, m11, m12, m13), extractAIC)
# Comparison of persistence models
lapply(list(c(m6, m7, m8, m9, m10, m11, m12, m13)), extractAIC)
list(c(m6, m7, m8, m9, m10, m11, m12, m13))
# Comparison of persistence models
lapply(m6, extractAIC)
# Comparison of persistence models
lmap(m6, extractAIC)
extractAIC(m6)
?glm
# Weight by sex
ggplot(traits, aes(x = sex, y = weight))+
geom_boxplot()+
theme_minimal()
View(data)
# Read in survival data
survival <- read.csv("Input/survival.csv") %>%
clean_names() %>%
rename(bird = identity) %>%
filter(bird %in% birds) %>%
# Limit persistence value to minimum common tracked time of 360
mutate(persist = ifelse(persist>360, 360, persist)) %>%
# Convert true and false to 0 and 1
mutate(to_90 = ifelse(to_90 == FALSE, 0, 1),
to_360 = ifelse(to_360 == FALSE, 0, 1)) %>%
# Drop unneeded columns
dplyr::select(c(bird, persist, to_90, to_360))
# Combine survival with all predictors
data <- left_join(survival, mlatency) %>%
left_join(handling) %>%
left_join(prop_behav) %>%
left_join(traits) %>%
# Drop un-needed behaviour columns
dplyr::select(-c(A, C, E, F, HB, HT, N, O, P, S, TW, W, D, I))
# Read in additional bird metadata
meta <- read_excel("Input/bsc assay data.xlsx", sheet = 8) %>%
clean_names() %>%
rename(bird = individual) %>%
select(c(bird, sex))
# And morphometrics
traits <- read_excel("Input/bsc assay data.xlsx", sheet = 10) %>%
clean_names()  %>%
select(c(identity, wing, tail, tarsus)) %>%
rename(bird = identity) %>%
filter(bird %in% birds) %>%
# Combine all traits data
left_join(meta) %>%
left_join(weights)
# Combine survival with all predictors
data <- left_join(survival, mlatency) %>%
left_join(handling) %>%
left_join(prop_behav) %>%
left_join(traits) %>%
# Drop un-needed behaviour columns
dplyr::select(-c(A, C, E, F, HB, HT, N, O, P, S, TW, W, D, I))
# Write table to file
write.csv(data, row.names = false, "data_table.csv")
# Write table to file
write.csv(data, row.names = FALSE, "data_table.csv")
View(survival)
6/14
summary(data$weight)
# Summary of traits
trait_sum <- traits %>%
group_by(sex) %>%
summarise(weight_mean = mean(weight),
weight_sd = sd(weight))
# Summary of weights
weight_sum <- traits %>%
group_by(sex) %>%
summarise(weight_mean = mean(weight),
weight_sd = sd(weight))
View(weight_sum)
# Test effect of alert behaviour - log rank test
summary(m11)
# Test effect of latency - log rank test
summary(m10)
summary(m7)
summary(km7)
# Test effect of weight - log rank test
summary(m12)
# Plot for paper
ggplot(data, aes(x = to_90, y = weight, colour = sex))+
geom_boxplot()
# Plot for paper
ggplot(data, aes(x= to_90, y=weight, group=to_90))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 90-days post-release",
y = "Pre-release weight")+
facet_wrap(~sex)
# Plot for paper
ggplot(data, aes(x= to_90, y=weight, group=to_90))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 90-days post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360))+
geom_boxplot()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme_minimal()+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360))+
geom_boxplot()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Kaplan Meyer Plot
ggsurvplot(km7, data = km, risk.table = FALSE,
gtheme = theme_bw(),
censor = FALSE,
xlab = "Days post-release",
ylab = "Survival",
xlim = c(0,360),
palette = c("#f8766d", "#83b0fc", "grey20"),
conf.int = FALSE)
# Kaplan Meyer Plot
ggsurvplot(km7, data = km, risk.table = FALSE,
gtheme = theme_bw(),
censor = FALSE,
xlab = "Days post-release",
ylab = "Survival",
xlim = c(0,360),
palette = c("grey20", "#83b0fc", "#f8766d"),
conf.int = FALSE)
# Plot for paper
ggplot(data, aes(x= sex, y=weight, fill=to_360))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= sex, y=weight, group = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~to_360)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= sex, y = weight, group = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~to_360)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= sex, y = weight))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~to_360)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= as.factor(sex), y = weight))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~to_360)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360, fill = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360, colour = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(x= to_360, y=weight, group=to_360, colour = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
facet_wrap(~sex)+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data, aes(y=weight, colour = to_360, group = sex))+
geom_violin()+
geom_point(size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data)+
geom_violin(aes(y=weight, colour = to_360, group = sex))+
geom_point(aes(x= sex, y=weight, colour = to_360), size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())+
scale_x_continuous(breaks = c(0,1), labels = c(FALSE, TRUE))
# Plot for paper
ggplot(data)+
geom_violin(aes(y=weight, colour = to_360, group = sex))+
geom_point(aes(x= sex, y=weight, colour = to_360), size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour = to_360, group = sex))+
geom_point(aes(x= sex, y=weight, colour = to_360), size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour = as.factor(to_360), group = sex))+
geom_point(aes(x= sex, y=weight, colour = to_360), size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour = as.factor(to_360), group = sex))+
geom_point(aes(x= sex, y=weight, colour = as.factor(to_360))), size = 2)+
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour = as.factor(to_360), group = sex))+
geom_point(aes(x= sex, y=weight, colour = as.factor(to_360)), size = 2)+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour = as.factor(to_360), group = sex))+
geom_point(aes(x= sex, y=weight, colour = as.factor(to_360)), size = 2)+
facet_wrap(~to_360)
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_minimal()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bql()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bw()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank()))
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360,
labeller = c("False", "True"))+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank())
# Plot for paper
data$to_360 <- factor(data$to_360, labels = c("False", "True"))
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360,
labeller = label_value))+
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360,
labeller = label_value)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank())
# Plot for paper
data$to_360 <- factor(data$to_360, labels = c("Survived: False", "Survived: True"))
ggplot(data)+
geom_violin(aes(x = sex, y=weight, colour =  sex))+
geom_point(aes(x= sex, y=weight, colour = sex), size = 2)+
facet_wrap(~to_360,
labeller = label_value)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = to_360, y=weight, colour =  sex))+
geom_point(aes(x= to_360, y=weight, colour = sex), size = 2)+
facet_wrap(~sex)+
theme_bw()+
labs(x= element_blank(),
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
axis.text.x= element_blank(),
axis.ticks = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = to_360, y=weight, colour =  sex))+
geom_point(aes(x= to_360, y=weight, colour = sex), size = 2)+
facet_wrap(~sex)+
theme_bw()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
legend.position = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = to_360, y=weight, colour =  sex))+
geom_point(aes(x= to_360, y=weight, colour = sex), size = 2)+
facet_wrap(~sex)+
theme_bw()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
legend.position = element_blank())
# Plot for paper
ggplot(data)+
geom_violin(aes(x = to_360, y=weight, colour =  sex))+
geom_point(aes(x= to_360, y=weight, colour = sex), size = 2)+
facet_wrap(~sex)+
theme_bw()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
legend.position = "none")
# Plot for paper
data$to_360 <- as.factor(data$to_360, labels = c(FALSE, TRUE))
# Plot for paper
data$to_360 <- as.factor(data$to_360, labels = c("FALSE", "TRUE"))
# Plot for paper
data$to_360 <- factor(data$to_360, labels = c("FALSE", "TRUE"))
ggplot(data)+
geom_violin(aes(x = to_360, y=weight, colour =  sex))+
geom_point(aes(x= to_360, y=weight, colour = sex), size = 2)+
facet_wrap(~sex)+
theme_bw()+
labs(x= "Survival to 1 year post-release",
y = "Pre-release weight")+
theme(panel.grid.minor = element_blank(),
legend.position = "none")
View(data)
View(mlatency)
View(weights)
View(handling)
